#! /usr/bin/env bash

usage=$(
	cat <<EOF
pvenv [PATH]
    pvenv /path/to/.envrc   Provide path of an existing .env/.envrc file
    pvenv /path/to/dir      Provide path to directory where a new .env/.envrc will be created
EOF
)

if [ -n "$1" ]; then
	envrc="$1"/.envrc
	dir="$1"
	if [[ -f $1 ]]; then
		envrc="$1"
		dir="$(
			builtin cd "$1" || echo "No dir, where the fuck am I?" && exit 1
			pwd
		)"
		touch "$envrc"
	else
		touch "$envrc"
	fi
else
	echo "$usage" && exit 1
fi

touch "$envrc" && asdf exec direnv allow
$EDITOR "$envrc"
python -m venv "$dir"
source "$dir"/bin/activate
